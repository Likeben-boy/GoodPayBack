# 外卖点餐系统架构图

## 整体系统架构

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                 用户终端层                                        │
├───────────────────────────────┬─────────────────────────────────────────────────┤
│      Web浏览器                 │            移动端App                          │
│    • Vue3/React前端            │         • iOS/Android                         │
│    • 响应式设计                │         • 原生应用                             │
└───────────────────────────────┴─────────────────────────────────────────────────┘
                                          │
                                  HTTPS请求
                                          │
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            Nginx 反向代理/负载均衡                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                              静态资源服务器                                        │
│                           • 前端静态文件托管                                       │
│                           • CDN内容分发                                           │
└─────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                  API路由转发
                                          │
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         Express.js 后端API服务                                    │
│                         TypeScript + Prisma ORM                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│  • 用户管理模块 (User Module)            • 餐厅管理模块 (Restaurant Module)     │
│  • 菜品管理模块 (Product Module)         • 购物车模块 (Cart Module)            │
│  • 订单管理模块 (Order Module)           • 支付模块 (Payment Module)            │
├─────────────────────────────────────────────────────────────────────────────────┤
│                              中间件层                                            │
│  • JWT认证中间件                         • express-validator 请求验证           │
│  • express-rate-limit 限流中间件         • morgan 日志中间件                     │
│  • helmet 安全中间件                     • cors 跨域中间件                        │
│  • 错误处理中间件                        • bcryptjs 密码加密                      │
└─────────────────────────────────────────────────────────────────────────────────┘
                                          │
                              Prisma ORM 数据访问
                                          │
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              数据存储层                                          │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────────────────────┐│
│  │                         MySQL 数据库                                          ││
│  │                        • 用户数据 (users)                                    ││
│  │                        • 餐厅数据 (restaurants)                              ││
│  │                        • 菜品数据 (products)                                 ││
│  │                        • 购物车数据 (carts)                                  ││
│  │                        • 订单数据 (orders)                                   ││
│  │                        • 地址数据 (addresses)                                ││
│  └─────────────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────────────┘
                                          │
                          计划中的第三方服务调用 (待实现)
                                          │
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              外部服务层 (待实现)                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│  • 支付服务 (微信支付/支付宝)          • 短信服务 (阿里云短信)                    │
│  • 邮件服务 (nodemailer)               • 文件存储服务 (待实现)                    │
└─────────────────────────────────────────────────────────────────────────────────┘

```

## 当前技术栈总结

### 后端技术栈 (已实现)
- **运行环境**: Node.js + TypeScript
- **Web框架**: Express.js 5.1.0
- **开发语言**: TypeScript 5.9.3
- **数据库ORM**: Prisma 6.17.1
- **数据库**: MySQL (通过mysql2驱动)
- **认证**: JWT (jsonwebtoken)
- **密码加密**: bcryptjs
- **日志**: Winston + morgan
- **进程管理**: PM2
- **包管理器**: pnpm 10.15.1
- **环境配置**: dotenv + dotenv-cli
- **开发工具**: tsx (TypeScript执行器)

### 中间件和工具 (已实现)
- **安全防护**: helmet
- **跨域处理**: cors
- **限流控制**: express-rate-limit
- **请求验证**: express-validator
- **文件处理**: multer (已安装但未启用)
- **邮件服务**: nodemailer (已安装但未启用)

### 前端技术栈 (计划中)
- **框架**: Vue.js 3 / React.js
- **构建工具**: Vite / Webpack
- **状态管理**: Vuex / Redux
- **UI组件**: Element Plus / Ant Design
- **HTTP客户端**: Axios
- **路由**: Vue Router / React Router

### 基础设施 (计划中)
- **反向代理**: Nginx
- **负载均衡**: Nginx
- **容器化**: Docker + Docker Compose
- **进程管理**: PM2 (已配置)
- **API文档**: Swagger/OpenAPI (待实现)

### 第三方服务 (待实现)
- **支付服务**: 微信支付、支付宝
- **短信服务**: 阿里云短信、腾讯云短信
- **邮件服务**: nodemailer (已安装)
- **文件存储**: 阿里云OSS、七牛云存储
- **缓存服务**: Redis (计划中)
- **地图服务**: 高德地图API、百度地图API

这个架构设计确保了系统的可扩展性、高可用性、安全性和可维护性，适合中大型外卖点餐业务的需求。